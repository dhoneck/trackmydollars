{% extends 'budgets/base.html' %}
{% block title %}DollarTracker | Assets & Debts{% endblock %}
{% block script %}<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>{%  endblock %}

{% block content %}
      <script>
          $(document).ready(function(){
              $(".success").fadeOut(10000);
          });
      </script>
      <h2>Assets & Debts</h2>
      <div id="net-worth-container">
        <h3>Net Worth</h3>
        <table id="net-worth-table">
          <tr>
            <td>Assets</td>
            <td><pre>{{ asset_total }}</pre></td>
          </tr>
          <tr>
            <td>Debts</td>
            <td><pre>{{ debt_total }}</pre></td>
          </tr>
          <tr>
            <td><strong>Net Worth</strong></td>
            <td><strong><pre>{{ net_worth_total }}</pre></strong></td>
          </tr>
        </table>
      </div>
      {% if messages %}
        {% for message in messages %}
          <p {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
        {% endfor %}
      {% endif %}


      <h3>Assets</h3>
      <div class="button-container">
        <button onclick="window.location.href = '{% url 'add-asset' %}';">Add Asset</button>
      </div>
      {% if assets  %}
      <table class="asset-debt-table">
        <tr>
          <th>Asset Name</th>
          <th>Asset Type</th>
          <th>Current Value</th>
          <th>Last Updated</th>
        {% for item in assets %}
          <tr>
            <td><a href="assets/{{ item.id }}/view">{{ item.name }}</a></td>
            <td><a href="assets/{{ item.id }}/view">{{ item.asset_type }}</a></td>
            {% if item.balances.first %}
              <td><a href="assets/{{ item.id }}/view">${{ item.balances.first }}</a></td>
            {% else %}
              <td></td>
            {% endif %}
            <td><a href="assets/{{ item.id }}/view">{{ item.balances.first.date }}</a></td>
          </tr>
        {% endfor %}
      </table>
      <br>
      <br>
      {% endif %}
      <br>
      <br>

      <h3>Installment Debts</h3>
      <div class="button-container">
        <button onclick="window.location.href = '{% url 'add-installment-debt' %}';">Add Installment Debt</button>
      </div>
      {% if installment_debts  %}
      <table class="asset-debt-table">
        <tr>
          <th>Debt Name</th>
          <th>Debt Type</th>
          <th>Initial Balance</th>
          <th>Current Balance</th>
          <th>Last Updated</th>
          {% for item in installment_debts %}
            <tr>
              <td><a href="installment-debts/{{ item.id }}/view">{{ item.name }}</a></td>
              {% if item.type %}
                <td><a href="installment-debts/{{ item.id }}/view">{{ item.type }}</a></td>
              {% else %}
                <td><a href="installment-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}

              {% if item.initial_amount %}
                <td><a href="installment-debts/{{ item.id }}/view">${{ item.initial_amount }}</a></td>
              {% else %}
                <td><a href="installment-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}
              {% if item.balances.first %}
                <td><a href="installment-debts/{{ item.id }}/view">${{ item.balances.first }}</a></td>
              {% else %}
                <td><a href="installment-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}

              {% if item.balances.first.date %}
                <td><a href="installment-debts/{{ item.id }}/view">{{ item.balances.first.date }}</a></td>
              {% elif item.date_opened %}
                <td><a href="installment-debts/{{ item.id }}/view">{{ item.date_opened }}</a></td>
              {% else %}
                <td><a href="installment-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}
            </tr>
          {% endfor %}
      </table>
      {% endif %}
      <br>
      <br>

      <h3>Revolving Debts</h3>
      <div class="button-container">
        <button onclick="window.location.href = '{% url 'add-revolving-debt' %}';">Add Revolving Debt</button>
      </div>
      {% if revolving_debts  %}
      <table class="asset-debt-table">
        <tr>
          <th>Debt Name</th>
          <th>Debt Type</th>
          <th>Credit Limit</th>
          <th>Current Balance</th>
          <th>Last Updated</th>
          {% for item in revolving_debts %}
            <tr>
              <td><a href="revolving-debts/{{ item.id }}/view">{{ item.name }}</a></td>
              {% if item.type %}
                <td><a href="revolving-debts/{{ item.id }}/view">{{ item.type }}</a></td>
              {% else %}
                <td><a href="revolving-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}
              {% if item.credit_limit %}
                <td><a href="revolving-debts/{{ item.id }}/view">${{ item.credit_limit }}</a></td>
              {% else %}
                <td><a href="revolving-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}
              {% if item.balances.first %}
                <td><a href="revolving-debts/{{ item.id }}/view">${{ item.balances.first }}</a></td>
              {% else %}
                <td><a href="revolving-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}

              {% if item.balances.first.date %}
                <td><a href="revolving-debts/{{ item.id }}/view">{{ item.balances.first.date }}</a></td>
              {% elif item.date_opened %}
                <td><a href="revolving-debts/{{ item.id }}/view">{{ item.date_opened }}</a></td>
              {% else %}
                <td><a href="revolving-debts/{{ item.id }}/view">n/a</a></td>
              {% endif %}
            </tr>
          {% endfor %}
      </table>
      {% endif %}
      <br>
      <br>
{% endblock %}